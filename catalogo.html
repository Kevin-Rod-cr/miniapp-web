<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CatÃ¡logo | Tienda Retro 80s</title>

  <!-- Bootstrap -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <!-- Estilos -->
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="d-flex justify-content-between align-items-center p-3">
    <h1>ğŸ›’ CatÃ¡logo de Productos</h1> 
    <div>
      <a href="index.html" class="btn btn-outline-light">â¬… Volver al inicio</a>
      <button id="verCarrito" class="btn btn-primary ms-2">ğŸ›ï¸ Ver carrito (<span id="contador">0</span>)</button>

      <!-- ğŸ”¹ NUEVA LÃNEA AÃ‘ADIDA -->
      <a href="contactenos.html" class="btn btn-success ms-2">ğŸ“ ContÃ¡ctenos</a>
    </div>
  </header>

  <div class="container mt-4">
    <div class="row" id="catalogo">
      <!-- Productos dinÃ¡micos se insertarÃ¡n aquÃ­ -->
    </div>
  </div>

  <footer>Â© 2025 Tienda Retro 80s</footer>

  <script>
    // ======== PRODUCTOS BASE ========
    const productosBase = [
      {
        id: 1,
        nombre: "Camisa Neon Vibes",
        precio: 85000,
        stock: 10,
        descripcion: "Camisa de algodÃ³n con estampado fluorescente inspirado en los 80s.",
        imagen: "assets/camisa1.jpg"
      },
      {
        id: 2,
        nombre: "Camisa Retro Flash",
        precio: 92000,
        stock: 8,
        descripcion: "Camisa con diseÃ±o de rayos y tonos elÃ©ctricos para un look ochentero.",
        imagen: "assets/camisa2.jpg"
      },
      {
        id: 3,
        nombre: "PantalÃ³n Acid Wash",
        precio: 115000,
        stock: 6,
        descripcion: "Jeans estilo acid wash, clÃ¡sico de los 80s, corte unisex.",
        imagen: "assets/pantalon1.jpg"
      },
      {
        id: 4,
        nombre: "PantalÃ³n Breakdance",
        precio: 99000,
        stock: 9,
        descripcion: "CÃ³modos pantalones deportivos con franjas laterales y diseÃ±o urbano.",
        imagen: "assets/pantalon2.jpg"
      },
      {
        id: 5,
        nombre: "PantalÃ³n Classic Fit",
        precio: 108000,
        stock: 5,
        descripcion: "PantalÃ³n negro ajustado, ideal para combinar con camisetas vibrantes.",
        imagen: "assets/pantalon3.jpg"
      }
    ];

    // ======== SINCRONIZAR CON LOCALSTORAGE ========
    let productos = JSON.parse(localStorage.getItem("productos")) || [];

    if (productos.length === 0) {
      // Si no hay productos guardados, se cargan los iniciales
      localStorage.setItem("productos", JSON.stringify(productosBase));
      productos = [...productosBase];
    }

    let carrito = [];

    // ======== MOSTRAR PRODUCTOS ========
    const contenedor = document.getElementById("catalogo");
    const contador = document.getElementById("contador");

    function renderCatalogo() {
      contenedor.innerHTML = "";
      productos = JSON.parse(localStorage.getItem("productos")) || [];

      productos.forEach((prod, index) => {
        const div = document.createElement("div");
        div.className = "col-md-4 mb-4";

        div.innerHTML = `
          <div class="card h-100 text-center p-3">
            <img src="${prod.imagen}" class="card-img-top rounded" alt="${prod.nombre}">
            <div class="card-body">
              <h5 class="card-title">${prod.nombre}</h5>
              <p class="card-text">${prod.descripcion}</p>
              <p><strong>$${prod.precio.toLocaleString('es-CO')}</strong></p>
              <button class="btn btn-primary" onclick="agregarAlCarrito(${prod.id})">Agregar al carrito</button>
            </div>
          </div>
        `;
        contenedor.appendChild(div);
      });
    }

    renderCatalogo();

    // ======== FUNCIONES DEL CARRITO ========
    function agregarAlCarrito(id) {
      const productosLS = JSON.parse(localStorage.getItem("productos")) || [];
      const producto = productosLS.find(p => p.id === id);
      const existente = carrito.find(item => item.id === id);

      if (!producto) {
        alert("âŒ Producto no encontrado.");
        return;
      }

      if (producto.stock <= 0) {
        alert("âŒ No hay mÃ¡s unidades disponibles de este producto.");
        return;
      }

      if (existente) {
        existente.cantidad++;
      } else {
        carrito.push({ ...producto, cantidad: 1 });
      }

      producto.stock--;
      localStorage.setItem("productos", JSON.stringify(productosLS)); // Actualiza el stock global
      actualizarContador();
      alert(`âœ… ${producto.nombre} fue agregado al carrito.`);
      renderCatalogo(); // Refresca el catÃ¡logo
    }

    function actualizarContador() {
      const total = carrito.reduce((acc, item) => acc + item.cantidad, 0);
      contador.textContent = total;
    }

    // ======== VER CARRITO ========
    document.getElementById("verCarrito").addEventListener("click", () => {
      if (carrito.length === 0) {
        alert("ğŸ›’ Tu carrito estÃ¡ vacÃ­o.");
        return;
      }

      let mensaje = "ğŸ›ï¸ Productos en tu carrito:\n\n";
      carrito.forEach(item => {
        mensaje += `${item.nombre} (x${item.cantidad}) - $${(item.precio * item.cantidad).toLocaleString('es-CO')}\n`;
      });

      mensaje += "\nÂ¿Deseas finalizar tu compra?";
      if (confirm(mensaje)) {
        alert("ğŸšš Tu pedido estÃ¡ en camino. Â¡Gracias por tu compra!");
        carrito = [];
        actualizarContador();
      }
    });
  </script>
</body>
</html>
